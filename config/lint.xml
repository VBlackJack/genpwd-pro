<?xml version="1.0" encoding="UTF-8"?>
<lint>
    <!-- Secret handling lint gates (custom detectors to be wired in Phase 5). -->
    <issue
        id="GenPwdSecretSetText"
        severity="fatal"
        message="Do not call setText() with secrets outside approved secure screens.">
        <option name="allowedRoutes" value="unlock_vault,vault_list,create_entry,edit_entry" />
        <option name="forbiddenPattern" value="set(Text|TextViewText).*password" />
    </issue>

    <issue
        id="GenPwdSensitiveLogging"
        severity="error"
        message="Replace raw Log.* calls handling passwords/tokens with SafeLog.">
        <option name="requiredWrapper" value="SafeLog" />
        <option name="forbiddenPattern" value="Log\.(d|i|w|e|v).*?(password|token|secret)" />
    </issue>

    <issue
        id="GenPwdMutablePendingIntent"
        severity="warning"
        message="PendingIntent.FLAG_MUTABLE requires a justification comment.">
        <option name="requireComment" value="justified" />
    </issue>
</lint>
